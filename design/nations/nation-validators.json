{
  "validate_doc_update":
    "function (newDoc, oldDoc, userCtx, secObj) {\n  function require(field) {\n   var errMessage = field + ' is required';\n    if (!newDoc[field]) {\n      throw { forbidden: errMessage };\n    }\n  }\n    function canWrite() {\n      var CAN_WRITE = true;\n      var readOnly = ['learner'];\n      if (!userCtx.isUserAdmin) {\n        if (userCtx.roles.length < 1) {\n          CAN_WRITE = false;\n        } else {\n          for (var i = 0; i < userCtx.roles.length; i++) {\n            if (~ readOnly.indexOf(userCtx.roles[i])) {\n              CAN_WRITE = false;\n            }\n          }\n        }\n      }\n      if(!CAN_WRITE) {\n        throw { forbidden: 'You have only read-only access' };\n      }\n    }\n    canWrite();\n    if (!newDoc) {\n      require('name');\n      require('adminName');\n      require('nationUrl');\n   }\n}"
}
